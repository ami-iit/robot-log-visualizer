#! /bin/bash
SCRIPT_DIR=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)

if command -v pyuic6 >/dev/null 2>&1; then
	PYUIC_CMD=(pyuic6)
elif [ -x "${SCRIPT_DIR}/.venv/bin/pyuic6" ]; then
	PYUIC_CMD=("${SCRIPT_DIR}/.venv/bin/pyuic6")
elif [ -x "${SCRIPT_DIR}/.venv/bin/python" ]; then
	PYUIC_CMD=("${SCRIPT_DIR}/.venv/bin/python" -m PyQt6.uic.pyuic)
elif command -v python >/dev/null 2>&1; then
	PYUIC_CMD=(python -m PyQt6.uic.pyuic)
elif command -v python3 >/dev/null 2>&1; then
	PYUIC_CMD=(python3 -m PyQt6.uic.pyuic)
else
	echo "Error: pyuic6 not found. Please install PyQt6 tools." >&2
	exit 1
fi

echo "Generate the main window"
"${PYUIC_CMD[@]}" -o robot_log_visualizer/ui/autogenerated/visualizer.py robot_log_visualizer/ui/misc/visualizer.ui

echo "Generate Additional windows"
"${PYUIC_CMD[@]}" -o  robot_log_visualizer/ui/autogenerated/about.py robot_log_visualizer/ui/misc/about.ui
"${PYUIC_CMD[@]}" -o  robot_log_visualizer/ui/autogenerated/set_robot_model.py robot_log_visualizer/ui/misc/set_robot_model.ui

echo "Generate tab"
"${PYUIC_CMD[@]}" -o  robot_log_visualizer/ui/autogenerated/plot_tab.py robot_log_visualizer/ui/misc/plot_tab.ui
"${PYUIC_CMD[@]}" -o  robot_log_visualizer/ui/autogenerated/video_tab.py robot_log_visualizer/ui/misc/video_tab.ui

echo "The ui is generated"
